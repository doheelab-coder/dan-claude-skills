---
name: dan-person-analysis
description: 사람명 디렉토리의 프로필, 카카오톡 대화 등을 분석하여 인물 정보를 정리
---

# Dan Person Analysis 스킬

사람명 디렉토리 내에 있는 프로필 정보, 정도희와의 카카오톡 대화내용 등을 분석하여 그 사람에 대한 정보(직업, 취미, 취향, 생활습관 등)를 마크다운으로 정리합니다.

## 실행 방법

```
/dan-person-analysis <사람명>
/dan-person-analysis          # input/ 내 모든 사람 디렉토리 처리
```

### 예시

```
/dan-person-analysis 이제연
/dan-person-analysis 김하나
/dan-person-analysis          # input/ 하위 모든 디렉토리 일괄 처리
```

## 경로

- **입력**: `/Users/dan.jung/Documents/code/dan-claude-skills/dan-person-analysis/input/{사람명}/`
- **출력**: `/Users/dan.jung/Documents/code/dan-claude-skills/dan-person-analysis/output/{사람명}.md`

## 입력 디렉토리 구조

```
input/{사람명}/
├── profile.png          # 앱 프로필 캡처 (1장 또는 여러 장)
├── profile_2.png        # 추가 프로필 페이지
├── kakao.txt            # 카카오톡 대화 내보내기 (.txt)
├── kakao.csv            # 카카오톡 대화 내보내기 (.csv)
├── memo.txt             # 직접 작성한 메모 (선택)
└── ...                  # 기타 이미지, 텍스트 파일
```

- 파일명/형식은 고정이 아님. 디렉토리 내 모든 파일을 읽어서 판단
- 이미지 파일: `.png`, `.jpg`, `.jpeg`, `.heic` → Read 도구로 읽기
- 텍스트 파일: `.txt`, `.csv` → Read 도구로 읽기
- PDF 파일: `.pdf` → Read 도구 (pages 파라미터)로 읽기

## 동작 절차

### Step 1: 입력 파싱

#### 사람명이 지정된 경우
```
input/{사람명}/ 디렉토리의 모든 파일을 읽기
```

#### 사람명이 없는 경우
```
input/ 하위의 모든 디렉토리를 조회하여 각각 처리
```

### Step 2: 파일 읽기 및 분류

디렉토리 내 모든 파일을 읽고 유형별로 분류:

1. **프로필 이미지**: 앱 프로필 캡처 → 닉네임, 나이, 소개, 성격, 취미, 관심사, I have, I want, 직업 등 추출
2. **카카오톡 대화**: 대화 내용에서 정보 추출
3. **메모/기타 텍스트**: 직접 작성한 메모 내용 반영

### Step 3: 카카오톡 대화 분석

카카오톡 내보내기 파일의 일반적인 형식:

```
{날짜} {시간}, {이름} : {메시지}
```

또는 CSV:
```
Date,User,Message
```

대화에서 추출할 정보:
- **직업/학교**: 회사, 업종, 직무, 학교, 전공 관련 언급
- **거주지**: 동네, 지역 관련 언급
- **취미/관심사**: 좋아하는 활동, 자주 하는 것
- **취향**: 음식, 음악, 영화, 여행지 등 선호
- **생활습관**: 기상/취침 시간, 운동 빈도, 식습관
- **성격/가치관**: 대화 스타일, 연애관, 인생관
- **일정/약속**: 만남 이력, 데이트 장소
- **특이사항**: 반려동물, 가족, 알레르기, 기념일 등

#### 분석 원칙

- **사실 기반**: 대화에서 직접 언급된 내용만 기록 (추측 X)
- **인용 포함**: 중요 정보는 원문 인용과 함께 기록 (날짜 포함)
- **정도희 발언 구분**: "정도희"가 나(사용자)의 이름. 상대방 발언만 분석 대상
- **시간순 정리**: 정보가 업데이트되면 최신 정보를 반영하되 이전 정보도 기록

### Step 4: 정보 종합 및 정리

모든 소스(프로필, 대화, 메모)의 정보를 종합하여 마크다운으로 정리.

### Step 5: 결과 저장

#### 파일 경로

```
output/{사람명}.md
```

#### 문서 구조

```markdown
# {사람명} 프로필

> 마지막 업데이트: YYYY-MM-DD

## 기본 정보

| 항목 | 내용 |
|------|------|
| 이름/닉네임 | {실명 또는 닉네임} |
| 나이 | {나이} |
| 거주지 | {거주 지역} |
| 직업 | {회사/업종/직무} |
| 학력 | {학교/전공} |

## 성격 및 가치관

- {성격 특성 1}: {근거 - 출처}
- {성격 특성 2}: {근거 - 출처}

## 취미 및 관심사

- {취미 1}: {상세 내용}
- {취미 2}: {상세 내용}

## 취향

### 음식
- 좋아하는: {리스트}
- 싫어하는/못먹는: {리스트}

### 음악/영화/드라마
- {선호 장르/작품}

### 패션/스타일
- {스타일 관련 정보}

## 생활습관

- 기상/취침: {패턴}
- 운동: {종류, 빈도}
- 식습관: {특이사항}
- 음주/흡연: {정보}

## 연애관 및 이상형

- {연애관 관련 정보}
- {이상형 관련 정보}

## 만남 이력

| 날짜 | 장소 | 내용 |
|------|------|------|
| {YYYY-MM-DD} | {장소} | {간단 설명} |

## 특이사항

- {반려동물, 가족, 기념일 등}

## 대화에서 얻은 주요 정보

- [{날짜}] {정보 내용} - "{원문 인용}"
- [{날짜}] {정보 내용} - "{원문 인용}"

---

*분석 소스: {사용된 파일 목록}*
```

### Step 6: 개인 Confluence 위키에 업로드

`output/{사람명}.md`를 Confluence Storage Format (XHTML)으로 변환하여 개인 위키에 업로드합니다.

- **사이트**: https://doheelab.atlassian.net/
- **스페이스 키**: `~6167d0ad07ac3c00689b46b0`
- **부모 페이지**: 관계 (ID: 40370179)
- **페이지 제목**: `{사람명} 프로필`
- **API 호출**: 항상 curl (python3 urllib) 사용 (MCP 도구 사용하지 않음)
- **인증**: `~/.claude/settings.json`의 `mcpServers.jira-personal.env.ATLASSIAN_API_TOKEN`

이미 동일 제목의 페이지가 있으면 업데이트 (버전 +1), 없으면 새로 생성합니다.

### Step 7: 기존 파일이 있으면 업데이트

`output/{사람명}.md`가 이미 존재하면:
1. 기존 파일을 읽어서 이전 정보 확인
2. 새로운 정보와 병합 (기존 정보 유지 + 신규 정보 추가)
3. 변경된 정보는 최신 내용으로 업데이트하되 이전 값도 기록
4. "마지막 업데이트" 날짜 갱신

## 중요 지침

- **진행 여부를 묻지 않고 끝까지 완료할 것**
- 대화 내용은 프라이버시에 민감하므로 파일 외부로 유출하지 않음
- "정도희"는 사용자 본인의 이름 → 상대방 정보만 분석
- 확실하지 않은 정보는 "(?)" 표시
- 모든 정보에는 출처(프로필/대화/메모) 명시
- 대화가 길 경우 전체를 꼼꼼히 읽고 정보 누락 없이 추출
